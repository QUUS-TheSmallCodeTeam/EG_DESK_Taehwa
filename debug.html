<!DOCTYPE html>
<html>
<head>
    <title>Debug EG-Desk</title>
    <style>
        body { font-family: monospace; padding: 20px; }
        .result { margin: 10px 0; padding: 10px; background: #f0f0f0; }
        .error { background: #ffcccc; }
        .success { background: #ccffcc; }
    </style>
</head>
<body>
    <h1>EG-Desk Debug</h1>
    <div id="results"></div>
    
    <script>
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `result ${type}`;
            div.textContent = message;
            document.getElementById('results').appendChild(div);
        }
        
        async function debugApp() {
            log('Starting debug...');
            
            try {
                // Create iframe to load the app
                const iframe = document.createElement('iframe');
                iframe.src = 'http://localhost:5173';
                iframe.style.width = '100%';
                iframe.style.height = '600px';
                iframe.style.border = '1px solid #ccc';
                document.body.appendChild(iframe);
                
                iframe.onload = () => {
                    log('App loaded in iframe', 'success');
                    
                    setTimeout(() => {
                        try {
                            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                            
                            // Check if main elements exist
                            const startScreen = iframeDoc.getElementById('start-screen');
                            const mainContent = iframeDoc.getElementById('main-content');
                            const browserContainer = iframeDoc.getElementById('browser-component-container');
                            const chatContainer = iframeDoc.getElementById('chat-component-container');
                            
                            log(`Start screen: ${startScreen ? 'EXISTS' : 'MISSING'}`, startScreen ? 'success' : 'error');
                            log(`Main content: ${mainContent ? 'EXISTS' : 'MISSING'}`, mainContent ? 'success' : 'error');
                            log(`Browser container: ${browserContainer ? 'EXISTS' : 'MISSING'}`, browserContainer ? 'success' : 'error');
                            log(`Chat container: ${chatContainer ? 'EXISTS' : 'MISSING'}`, chatContainer ? 'success' : 'error');
                            
                            // Try to click blog button
                            const blogButton = iframeDoc.querySelector('[data-workspace="blog"]');
                            if (blogButton) {
                                log('Found blog button, clicking...', 'success');
                                blogButton.click();
                                
                                setTimeout(() => {
                                    const isActive = mainContent && mainContent.classList.contains('active');
                                    log(`Main content active: ${isActive}`, isActive ? 'success' : 'error');
                                    
                                    // Check if components are rendered
                                    const browserComponent = iframeDoc.querySelector('#browser-component-container .browser-tab-component');
                                    const chatComponent = iframeDoc.querySelector('#chat-component-container .chat-component');
                                    const urlBar = iframeDoc.querySelector('.address-bar');
                                    
                                    log(`Browser component: ${browserComponent ? 'RENDERED' : 'NOT RENDERED'}`, browserComponent ? 'success' : 'error');
                                    log(`Chat component: ${chatComponent ? 'RENDERED' : 'NOT RENDERED'}`, chatComponent ? 'success' : 'error');
                                    log(`URL bar: ${urlBar ? 'EXISTS' : 'MISSING'}`, urlBar ? 'success' : 'error');
                                    
                                    if (browserContainer) {
                                        log(`Browser container innerHTML length: ${browserContainer.innerHTML.length}`);
                                    }
                                    if (chatContainer) {
                                        log(`Chat container innerHTML length: ${chatContainer.innerHTML.length}`);
                                    }
                                }, 2000);
                                
                            } else {
                                log('Blog button not found', 'error');
                            }
                            
                        } catch (e) {
                            log(`Error accessing iframe: ${e.message}`, 'error');
                        }
                    }, 1000);
                };
                
            } catch (error) {
                log(`Error: ${error.message}`, 'error');
            }
        }
        
        debugApp();
    </script>
</body>
</html>
